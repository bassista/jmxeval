<?xml version="1.0" encoding="UTF-8"?>
<jmxeval:jmxeval xmlns:jmxeval="http://www.adahas.com/schema/jmxeval-1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <connection url="service:jmx:rmi:///jndi/rmi://${host}:${port}/jmxrmi" ssl="false" username="${username:}" password="${password:}">
    <eval name="Heap Usage">
      <query var="heapmax" objectName="java.lang:type=Memory" attribute="max" compositeAttribute="HeapMemoryUsage" />
      <expr var="heapcritical" expression="${heapmax} / 100 * ${critical:80}" />
      <expr var="heapwarning" expression="${heapmax} / 100 * ${warning:60}" />

      <query var="heapusage" objectName="java.lang:type=Memory" attribute="used" compositeAttribute="HeapMemoryUsage">
        <perf warning="${heapwarning}" critical="${heapcritical}" />
      </query>
      <expr var="heappercentage" expression="${heapusage} / ${heapmax}" scale="0" />
      <check useVar="heappercentage" warning="${warning:60}" critical="${critical:80}" message="Heap usage is ${heappercentage}%">
        <perf />
      </check>
    </eval>
  </connection>
</jmxeval:jmxeval>